{% extends "djangoapp/base.html" %}
<!-- 
    EXTENDS BASE TEMPLATE BLOCKS:
    - title
    - imports
    - content
    - scripts
-->

{% load static %}

<!-- UPDATE TITLE-->
{% block title %}Share your review{% endblock %}

<!-- ADDTIONAL IMPORTS-->
{% block imports %}
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.5.0/css/bootstrap-datepicker.css" rel="stylesheet">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.5.0/js/bootstrap-datepicker.js"></script>
{% endblock imports %}

<!-- PAGE CONTENT-->
{% block content %}
    <!--DEBUG INFO
        ** Context item "cars" **
        {{cars}}

        **Car Make info for each car**
        {% for car in cars %}
        {{car.car_make.name}} | "{{car.car_make.description}}"
        {% endfor %}

        **alt attempt since i think the issue is M2M field:**
        {% for car in cars %}
            {% for cm in car.car_make.all %}
            {{cm.name}} | "{{cm.description}}"
            {% endfor %}
        {% endfor %}
    -->
    <!-- Status Info if it's in the context -->
    <div>
        <p><i>{{status}}</i></p>
    </div>
    <!--Review form -->
    <div class="form-group">
        {% if user.is_authenticated %}
        <form action="{% url 'djangoapp:add_review' dealer_id %}" method="POST">
            <div class="form-header">
                <h1>Share Your Review</h1>
                <hr>
                <!--show user's first + last name here? to show who's submitting-->
                <p><b>Posting review as:</b> {{user.first_name}} {{user.last_name}}</p>
            </div>
            <div class="form-inputs">
                <!--Review Content-->
                <label for="review">Review Content</label>
                <textarea class="form-control" name="review" id="review" rows="2" required></textarea>
                <!--Purchase check toggle-->
                <label for="purchase">Purchase Made?</label>
                <input class="form-check-input" type="checkbox" name="purchase" id="purchase">
                <!--Purchase Date-->
                <label for="purchase_date">Purchase Date</label>
                <input class="date-own form-control" type="date" placeholder="" name="purchase_date" id="purchase_date">
                <!--Car Make Dropdown-->
                <label for="car">Select Your Car</label>
                <select class="form-select" name="car" id="car" required>
                    {% for car in cars %}
                    <option>{{car.name}} - {{car.car_make.name}} - {{car.car_year|date:"Y"}}</option> 
                    <!-- car_make.name doesn't appear because of M2M relationship, requires more filtering... -->
                    {% endfor %}
                </select>
                <!--Car Model-
                <label for="car_model">Car Model</label>
                <input type="text" placeholder="" name="car_model">
                <--Car Year
                <label for="car_year">Car Year</label>
                <input type="text" placeholder="" name="car_year">
                -->
                <div>
                    {% csrf_token %}
                    <button class="btn btn-primary btn-block" type="submit">Post</button>
                </div>
            </div>
        </form>
        {% else %}
            <h3>Please sign in to post a review.</h3>
        {% endif %}
    </div>
{% endblock content %}

<!-- ADDITIONAL JAVASCRIPT -->
{% block scripts %}
<script type="text/javascript">
    $('.date-own').datepicker({
        format: 'mm/dd/yyyy'
    });
</script>
{% endblock scripts %}